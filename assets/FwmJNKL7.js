import{r as k,o as q,t as L,v as I,x as r,J as R,K as $,u as Q,L as B,M as x,j as O,y as v,N as y,z as b,A as U,B as S,O as P}from"./CEWShhMP.js";import T from"./CEWOo0At.js";import{a as z,g as M,b as V,c as j}from"./DWHMFDJE.js";import{g as Y,a as X}from"./DielePOz.js";import{_ as F}from"./BeMp0MfL.js";const J=""+new URL("scratchCard.DS1kSqh_.jpg",import.meta.url).href,K={ref:"wrapper",class:"scratch-wrapper"},G=["width","height"],H={__name:"scratch",props:{width:{type:Number,default:300},height:{type:Number,default:120},brush:{type:Number,default:25},threshold:{type:Number,default:50}},emits:["completed"],setup(h,{expose:e,emit:i}){const o=h,p=i,u=k(null);let c,a=!1,d=!1;const N=(t,s)=>{c.globalCompositeOperation="destination-out",c.beginPath(),c.arc(t,s,o.brush,0,Math.PI*2),c.fill()},D=()=>{const{data:t}=c.getImageData(0,0,o.width,o.height);let s=0;for(let m=3;m<t.length;m+=4)t[m]===0&&s++;return s/(o.width*o.height)*100},_=t=>{var g,l,n,f;if(!a||d)return;const s=u.value.getBoundingClientRect(),m=(((l=(g=t.touches)==null?void 0:g[0])==null?void 0:l.clientX)??t.clientX)-s.left,C=(((f=(n=t.touches)==null?void 0:n[0])==null?void 0:f.clientY)??t.clientY)-s.top;N(m,C),D()>o.threshold&&(d=!0,p("completed"))};return e({revealAll:()=>{c&&(c.clearRect(0,0,o.width,o.height),d=!0)}}),q(()=>{c=u.value.getContext("2d",{willReadFrequently:!0});const t=new Image;t.src=J,t.onload=()=>{c.drawImage(t,0,0,o.width,o.height)};const s=u.value;s.addEventListener("mousedown",()=>a=!0),s.addEventListener("mouseup",()=>a=!1),s.addEventListener("mousemove",_),s.addEventListener("touchstart",()=>a=!0),s.addEventListener("touchend",()=>a=!1),s.addEventListener("touchmove",_)}),(t,s)=>(I(),L("div",K,[r("canvas",{ref_key:"canvas",ref:u,width:h.width,height:h.height},null,8,G),r("div",{class:"content",style:$({width:h.width+"px",height:h.height+"px"})},[R(t.$slots,"default")],4)],512))}},W={class:"questSection flex justify-around grow rounded-t-[20px] p-8"},Z={class:"min-w-full flex flex-col gap-y-[15px]"},tt={class:"questOption flex justify-around"},et={class:"questText min-w-[200px] flex justify-center items-center grow"},st={class:"flex justify-center items-center"},nt={class:"flex justify-center items-center grow text-center"},ot={class:"flex justify-center items-center"},at={__name:"slugPage",async setup(h){let e,i;const o=k(null),p=Q(),u=B(),c=([e,i]=x(()=>z.get()),e=await e,i(),e),a=([e,i]=x(()=>M(c)),e=await e,i(),e),d=Y();[e,i]=x(()=>V(d)),e=await e,i();const D=O(()=>X(d)).value,_=Object.values(D),A=u.params.slug;let t={};const s=_.find(l=>t=l.quiz.find(n=>n.slug==A));async function m(){try{const l=a.questID,n=a.data,f=[...l,t.id],w=String(Number(n)+Number(t.price));await j(a,f,w)}finally{await p.push("/")}}async function C(){try{const n=[...a.questID,t.id];await j(a,n)}finally{await p.push("/")}}function g(){var l;(l=o.value)==null||l.revealAll()}return(l,n)=>{const f=H,w=T;return I(),L("section",W,[r("div",Z,[r("div",tt,[r("div",null,v(y(s).name),1),r("div",null,v(y(t).price),1)]),r("div",et,[r("div",null,v(y(t).quest),1)]),r("div",st,[b(f,{ref_key:"scratch",ref:o,width:200,height:60,threshold:80,onCompleted:g},{default:U(()=>[r("div",nt,v(y(t).answer),1)]),_:1},512)]),r("div",ot,[r("button",{type:"button",class:"btn",onClick:n[0]||(n[0]=E=>m())},[b(w,{class:"btnIcon",name:"icon-park-solid:correct",style:{color:"green"},size:"20px"}),n[2]||(n[2]=S("Yes",-1))]),r("button",{type:"button",class:"btn",onClick:n[1]||(n[1]=E=>C())},[b(w,{class:"btnIcon",name:"icomoon-free:cross",style:{color:"red"},size:"20px"}),n[3]||(n[3]=S("No",-1))])])])])}}},dt={__name:"[slug]",async setup(h){let e,i;const o=Q(),p=([e,i]=x(()=>z.get()),e=await e,i(),e);return q(async()=>{}),(u,c)=>{const a=at,d=F;return I(),P(d,null,{default:U(()=>[b(a)]),_:1})}}};export{dt as default};
