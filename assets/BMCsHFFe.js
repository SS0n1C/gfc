import{r as j,m as L,c as Q,o as S,a as o,n as $,p as z,u as U,q as B,s as y,v as P,t as v,x,b,w as E,d as q,y as T}from"./BhAl0oiT.js";import O from"./CKmyw-up.js";import{a as R,g as V,b as Y,c as k}from"./Dloc056_.js";import{g as M,a as X}from"./LVRxlZ07.js";import{_ as F}from"./BJAJd248.js";const G=""+new URL("scratchCard.DS1kSqh_.jpg",import.meta.url).href,H={ref:"wrapper",class:"scratch-wrapper"},J=["width","height"],K={__name:"scratch",props:{width:{type:Number,default:300},height:{type:Number,default:120},brush:{type:Number,default:25},threshold:{type:Number,default:50}},emits:["completed"],setup(h,{expose:e,emit:l}){const a=h,p=l,u=j(null);let c,r=!1,d=!1;const A=(t,s)=>{c.globalCompositeOperation="destination-out",c.beginPath(),c.arc(t,s,a.brush,0,Math.PI*2),c.fill()},D=()=>{const{data:t}=c.getImageData(0,0,a.width,a.height);let s=0;for(let m=3;m<t.length;m+=4)t[m]===0&&s++;return s/(a.width*a.height)*100},g=t=>{var _,i,n,f;if(!r||d)return;const s=u.value.getBoundingClientRect(),m=(((i=(_=t.touches)==null?void 0:_[0])==null?void 0:i.clientX)??t.clientX)-s.left,C=(((f=(n=t.touches)==null?void 0:n[0])==null?void 0:f.clientY)??t.clientY)-s.top;A(m,C),D()>a.threshold&&(d=!0,p("completed"))};return e({revealAll:()=>{c&&(c.clearRect(0,0,a.width,a.height),d=!0)}}),L(()=>{c=u.value.getContext("2d",{willReadFrequently:!0});const t=new Image;t.src=G,t.onload=()=>{c.drawImage(t,0,0,a.width,a.height)};const s=u.value;s.addEventListener("mousedown",()=>r=!0),s.addEventListener("mouseup",()=>r=!1),s.addEventListener("mousemove",g),s.addEventListener("touchstart",()=>r=!0),s.addEventListener("touchend",()=>r=!1),s.addEventListener("touchmove",g)}),(t,s)=>(S(),Q("div",H,[o("canvas",{ref_key:"canvas",ref:u,width:h.width,height:h.height},null,8,J),o("div",{class:"content",style:z({width:h.width+"px",height:h.height+"px"})},[$(t.$slots,"default")],4)],512))}},W={class:"questSection flex justify-around grow rounded-t-[20px] p-8"},Z={class:"min-w-full flex flex-col gap-y-[15px]"},tt={class:"questOption flex justify-around"},et={class:"questText min-w-[200px] max-h-[250px] flex justify-center items-center grow"},st={class:"flex justify-center items-center"},nt={class:"flex justify-center items-center grow text-center"},ot={class:"flex justify-center items-center mt-[30px]"},at={__name:"slugPage",async setup(h){let e,l;const a=j(null),p=U(),u=B(),c=([e,l]=y(()=>R.get()),e=await e,l(),e),r=([e,l]=y(()=>V(c)),e=await e,l(),e),d=M();[e,l]=y(()=>Y(d)),e=await e,l();const D=P(()=>X(d)).value,g=Object.values(D),N=u.params.slug;let t={};const s=g.find(i=>t=i.quiz.find(n=>n.slug==N));async function m(){try{const i=r.questID,n=r.data;let f=String(++r.correctAnswer);const w=[...i,t.id],I=String(Number(n)+Number(t.price));await k(r,w,I,void 0,void 0,f)}finally{await p.push("/")}}async function C(){try{const n=[...r.questID,t.id];await k(r,n)}finally{await p.push("/")}}function _(){var i;(i=a.value)==null||i.revealAll()}return(i,n)=>{const f=K,w=O;return S(),Q("section",W,[o("div",Z,[o("div",tt,[o("div",null,[o("h4",null,v(x(s).name),1)]),o("div",null,[o("h4",null,v(x(t).price),1)])]),o("div",et,[o("div",null,v(x(t).quest),1)]),o("div",st,[b(f,{ref_key:"scratch",ref:a,width:200,height:60,threshold:80,onCompleted:_},{default:E(()=>[o("div",nt,v(x(t).answer),1)]),_:1},512)]),o("div",ot,[o("button",{type:"button",class:"btn",onClick:n[0]||(n[0]=I=>m())},[b(w,{class:"btnIcon",name:"icon-park-solid:correct",style:{color:"green"},size:"20px"}),n[2]||(n[2]=q("Yes",-1))]),o("button",{type:"button",class:"btn",onClick:n[1]||(n[1]=I=>C())},[b(w,{class:"btnIcon",name:"icomoon-free:cross",style:{color:"red"},size:"20px"}),n[3]||(n[3]=q("No",-1))])])])])}}},dt={__name:"[slug]",async setup(h){let e,l;const a=U(),p=([e,l]=y(()=>R.get()),e=await e,l(),e);return L(async()=>{}),(u,c)=>{const r=at,d=F;return S(),T(d,null,{default:E(()=>[b(r)]),_:1})}}};export{dt as default};
