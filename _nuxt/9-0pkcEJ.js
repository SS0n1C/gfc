import{_ as L,r as Q,o as q,t as U,v as z,x as o,J as $,K as B,u as R,L as O,M as D,j as T,N as M,A as N,y as w,O as y,z as I,B as j}from"./C6dWCIEW.js";import V from"./BVQA_eCd.js";import{_ as Y}from"./NXYR4Rha.js";import{u as P,a as X,g as F,b as J,c as k}from"./CIoVxpZP.js";import{g as K,a as G}from"./CFatuBAh.js";const H={ref:"wrapper",class:"scratch-wrapper"},W=["width","height"],Z={__name:"scratch",props:{width:{type:Number,default:300},height:{type:Number,default:120},brush:{type:Number,default:25},threshold:{type:Number,default:50}},emits:["completed"],setup(d,{expose:n,emit:l}){const a=d,p=l,h=Q(null);let r,i=!1,f=!1;const C=(t,e)=>{r.globalCompositeOperation="destination-out",r.beginPath(),r.arc(t,e,a.brush,0,Math.PI*2),r.fill()},x=()=>{const{data:t}=r.getImageData(0,0,a.width,a.height);let e=0;for(let u=3;u<t.length;u+=4)t[u]===0&&e++;return e/(a.width*a.height)*100},_=t=>{var g,c,s,m;if(!i||f)return;const e=h.value.getBoundingClientRect(),u=(((c=(g=t.touches)==null?void 0:g[0])==null?void 0:c.clientX)??t.clientX)-e.left,b=(((m=(s=t.touches)==null?void 0:s[0])==null?void 0:m.clientY)??t.clientY)-e.top;C(u,b),x()>a.threshold&&(f=!0,p("completed"))};return n({revealAll:()=>{r&&(r.clearRect(0,0,a.width,a.height),f=!0)}}),q(()=>{r=h.value.getContext("2d",{willReadFrequently:!0});const t=new Image;t.src="/scratchCard.jpg",t.onload=()=>{r.drawImage(t,0,0,a.width,a.height)};const e=h.value;e.addEventListener("mousedown",()=>i=!0),e.addEventListener("mouseup",()=>i=!1),e.addEventListener("mousemove",_),e.addEventListener("touchstart",()=>i=!0),e.addEventListener("touchend",()=>i=!1),e.addEventListener("touchmove",_)}),(t,e)=>(z(),U("div",H,[o("canvas",{ref_key:"canvas",ref:h,width:d.width,height:d.height},null,8,W),o("div",{class:"content",style:B({width:d.width+"px",height:d.height+"px"})},[$(t.$slots,"default",{},void 0,!0)],4)],512))}},tt=L(Z,[["__scopeId","data-v-950240c1"]]),et={class:"flex justify-around grow rounded-t-[20px] p-8"},st={class:"min-w-full flex flex-col gap-y-[15px]"},nt={class:"questOption flex justify-around"},ot={class:"questText min-w-[200px] flex justify-center items-center grow"},at={class:"flex justify-center items-center grow"},rt={class:"flex justify-center items-center grow text-center"},ct={class:"flex justify-center items-center"},it={__name:"[slug]",async setup(d){let n,l;const a=Q(null),p=R(),h=O();P();const r=([n,l]=D(()=>X.get()),n=await n,l(),n),i=([n,l]=D(()=>F(r)),n=await n,l(),n),f=K();[n,l]=D(()=>J(f)),n=await n,l();const x=T(()=>G(f)).value,_=Object.values(x),A=h.params.slug;let t={};const e=_.find(c=>t=c.quiz.find(s=>s.slug==A));async function u(){try{const c=i.questID,s=i.data,m=[...c,t.id],v=String(Number(s)+Number(t.price));await k(i,m,v)}finally{await p.push("/")}}async function b(){try{const s=[...i.questID,t.id];await k(i,s)}finally{await p.push("/")}}function g(){var c;(c=a.value)==null||c.revealAll()}return q(async()=>{}),(c,s)=>{const m=tt,v=V,E=Y;return z(),M(E,null,{default:N(()=>[o("section",et,[o("div",st,[o("div",nt,[o("div",null,w(y(e).name),1),o("div",null,w(y(t).price),1)]),o("div",ot,[o("div",null,w(y(t).quest),1)]),o("div",at,[I(m,{ref_key:"scratch",ref:a,width:200,height:60,threshold:80,onCompleted:g},{default:N(()=>[o("div",rt,w(y(t).answer),1)]),_:1},512)]),o("div",ct,[o("button",{type:"button",class:"btn",onClick:s[0]||(s[0]=S=>u())},[I(v,{class:"btnIcon",name:"icon-park-solid:correct",style:{color:"green"},size:"20px"}),s[2]||(s[2]=j("Yes"))]),o("button",{type:"button",class:"btn",onClick:s[1]||(s[1]=S=>b())},[I(v,{class:"btnIcon",name:"icomoon-free:cross",style:{color:"red"},size:"20px"}),s[3]||(s[3]=j("No"))])])])])]),_:1})}}},mt=L(it,[["__scopeId","data-v-6ab43432"]]);export{mt as default};
