import{r as k,o as q,t as L,v as I,x as o,J as R,K as $,u as Q,L as B,M as x,j as O,y as v,N as y,z as b,A as U,B as S,O as P}from"./BRUQDR2C.js";import T from"./AANZny-b.js";import{a as z,g as M,b as V,c as j}from"./DWHMFDJE.js";import{g as Y,a as X}from"./Ctd_hxB1.js";import{_ as F}from"./uidMmjW6.js";const J=""+new URL("scratchCard.DS1kSqh_.jpg",import.meta.url).href,K={ref:"wrapper",class:"scratch-wrapper"},G=["width","height"],H={__name:"scratch",props:{width:{type:Number,default:300},height:{type:Number,default:120},brush:{type:Number,default:25},threshold:{type:Number,default:50}},emits:["completed"],setup(h,{expose:e,emit:l}){const a=h,p=l,u=k(null);let c,r=!1,d=!1;const N=(t,s)=>{c.globalCompositeOperation="destination-out",c.beginPath(),c.arc(t,s,a.brush,0,Math.PI*2),c.fill()},D=()=>{const{data:t}=c.getImageData(0,0,a.width,a.height);let s=0;for(let m=3;m<t.length;m+=4)t[m]===0&&s++;return s/(a.width*a.height)*100},_=t=>{var g,i,n,f;if(!r||d)return;const s=u.value.getBoundingClientRect(),m=(((i=(g=t.touches)==null?void 0:g[0])==null?void 0:i.clientX)??t.clientX)-s.left,C=(((f=(n=t.touches)==null?void 0:n[0])==null?void 0:f.clientY)??t.clientY)-s.top;N(m,C),D()>a.threshold&&(d=!0,p("completed"))};return e({revealAll:()=>{c&&(c.clearRect(0,0,a.width,a.height),d=!0)}}),q(()=>{c=u.value.getContext("2d",{willReadFrequently:!0});const t=new Image;t.src=J,t.onload=()=>{c.drawImage(t,0,0,a.width,a.height)};const s=u.value;s.addEventListener("mousedown",()=>r=!0),s.addEventListener("mouseup",()=>r=!1),s.addEventListener("mousemove",_),s.addEventListener("touchstart",()=>r=!0),s.addEventListener("touchend",()=>r=!1),s.addEventListener("touchmove",_)}),(t,s)=>(I(),L("div",K,[o("canvas",{ref_key:"canvas",ref:u,width:h.width,height:h.height},null,8,G),o("div",{class:"content",style:$({width:h.width+"px",height:h.height+"px"})},[R(t.$slots,"default")],4)],512))}},W={class:"questSection flex justify-around grow rounded-t-[20px] p-8"},Z={class:"min-w-full flex flex-col gap-y-[15px]"},tt={class:"questOption flex justify-around"},et={class:"questText min-w-[200px] max-h-[250px] flex justify-center items-center grow"},st={class:"flex justify-center items-center"},nt={class:"flex justify-center items-center grow text-center"},ot={class:"flex justify-center items-center"},at={__name:"slugPage",async setup(h){let e,l;const a=k(null),p=Q(),u=B(),c=([e,l]=x(()=>z.get()),e=await e,l(),e),r=([e,l]=x(()=>M(c)),e=await e,l(),e),d=Y();[e,l]=x(()=>V(d)),e=await e,l();const D=O(()=>X(d)).value,_=Object.values(D),A=u.params.slug;let t={};const s=_.find(i=>t=i.quiz.find(n=>n.slug==A));async function m(){try{const i=r.questID,n=r.data,f=[...i,t.id],w=String(Number(n)+Number(t.price));await j(r,f,w)}finally{await p.push("/")}}async function C(){try{const n=[...r.questID,t.id];await j(r,n)}finally{await p.push("/")}}function g(){var i;(i=a.value)==null||i.revealAll()}return(i,n)=>{const f=H,w=T;return I(),L("section",W,[o("div",Z,[o("div",tt,[o("div",null,[o("h4",null,v(y(s).name),1)]),o("div",null,[o("h4",null,v(y(t).price),1)])]),o("div",et,[o("div",null,v(y(t).quest),1)]),o("div",st,[b(f,{ref_key:"scratch",ref:a,width:200,height:60,threshold:80,onCompleted:g},{default:U(()=>[o("div",nt,v(y(t).answer),1)]),_:1},512)]),o("div",ot,[o("button",{type:"button",class:"btn",onClick:n[0]||(n[0]=E=>m())},[b(w,{class:"btnIcon",name:"icon-park-solid:correct",style:{color:"green"},size:"20px"}),n[2]||(n[2]=S("Yes",-1))]),o("button",{type:"button",class:"btn",onClick:n[1]||(n[1]=E=>C())},[b(w,{class:"btnIcon",name:"icomoon-free:cross",style:{color:"red"},size:"20px"}),n[3]||(n[3]=S("No",-1))])])])])}}},dt={__name:"[slug]",async setup(h){let e,l;const a=Q(),p=([e,l]=x(()=>z.get()),e=await e,l(),e);return q(async()=>{}),(u,c)=>{const r=at,d=F;return I(),P(d,null,{default:U(()=>[b(r)]),_:1})}}};export{dt as default};
