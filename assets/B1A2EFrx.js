import{_ as k,r as q,o as L,t as Q,v as C,x as r,J as B,K as R,u as S,L as O,M as y,j as P,y as w,N as x,z as b,A as z,B as j,O as T}from"./S12f--6u.js";import M from"./DTx55V07.js";import{a as E,g as V,b as Y,c as $}from"./DWHMFDJE.js";import{g as X,a as F}from"./B4SPNy3o.js";import{_ as J}from"./1jTKqiRk.js";const K={ref:"wrapper",class:"scratch-wrapper"},G=["width","height"],H={__name:"scratch",props:{width:{type:Number,default:300},height:{type:Number,default:120},brush:{type:Number,default:25},threshold:{type:Number,default:50}},emits:["completed"],setup(h,{expose:e,emit:i}){const o=h,m=i,u=q(null);let c,a=!1,d=!1;const N=(t,s)=>{c.globalCompositeOperation="destination-out",c.beginPath(),c.arc(t,s,o.brush,0,Math.PI*2),c.fill()},D=()=>{const{data:t}=c.getImageData(0,0,o.width,o.height);let s=0;for(let _=3;_<t.length;_+=4)t[_]===0&&s++;return s/(o.width*o.height)*100},f=t=>{var g,l,n,p;if(!a||d)return;const s=u.value.getBoundingClientRect(),_=(((l=(g=t.touches)==null?void 0:g[0])==null?void 0:l.clientX)??t.clientX)-s.left,I=(((p=(n=t.touches)==null?void 0:n[0])==null?void 0:p.clientY)??t.clientY)-s.top;N(_,I),D()>o.threshold&&(d=!0,m("completed"))};return e({revealAll:()=>{c&&(c.clearRect(0,0,o.width,o.height),d=!0)}}),L(()=>{c=u.value.getContext("2d",{willReadFrequently:!0});const t=new Image;t.src="scratchCard.jpg",t.onload=()=>{c.drawImage(t,0,0,o.width,o.height)};const s=u.value;s.addEventListener("mousedown",()=>a=!0),s.addEventListener("mouseup",()=>a=!1),s.addEventListener("mousemove",f),s.addEventListener("touchstart",()=>a=!0),s.addEventListener("touchend",()=>a=!1),s.addEventListener("touchmove",f)}),(t,s)=>(C(),Q("div",K,[r("canvas",{ref_key:"canvas",ref:u,width:h.width,height:h.height},null,8,G),r("div",{class:"content",style:R({width:h.width+"px",height:h.height+"px"})},[B(t.$slots,"default",{},void 0,!0)],4)],512))}},W=k(H,[["__scopeId","data-v-9ac0d6ed"]]),Z={class:"questSection flex justify-around grow rounded-t-[20px] p-8"},tt={class:"min-w-full flex flex-col gap-y-[15px]"},et={class:"questOption flex justify-around"},st={class:"questText min-w-[200px] flex justify-center items-center grow"},nt={class:"flex justify-center items-center grow"},ot={class:"flex justify-center items-center grow text-center"},at={class:"flex justify-center items-center"},rt={__name:"slugPage",async setup(h){let e,i;const o=q(null),m=S(),u=O(),c=([e,i]=y(()=>E.get()),e=await e,i(),e),a=([e,i]=y(()=>V(c)),e=await e,i(),e),d=X();[e,i]=y(()=>Y(d)),e=await e,i();const D=P(()=>F(d)).value,f=Object.values(D),A=u.params.slug;let t={};const s=f.find(l=>t=l.quiz.find(n=>n.slug==A));async function _(){try{const l=a.questID,n=a.data,p=[...l,t.id],v=String(Number(n)+Number(t.price));await $(a,p,v)}finally{await m.push("/")}}async function I(){try{const n=[...a.questID,t.id];await $(a,n)}finally{await m.push("/")}}function g(){var l;(l=o.value)==null||l.revealAll()}return(l,n)=>{const p=W,v=M;return C(),Q("section",Z,[r("div",tt,[r("div",et,[r("div",null,w(x(s).name),1),r("div",null,w(x(t).price),1)]),r("div",st,[r("div",null,w(x(t).quest),1)]),r("div",nt,[b(p,{ref_key:"scratch",ref:o,width:200,height:60,threshold:80,onCompleted:g},{default:z(()=>[r("div",ot,w(x(t).answer),1)]),_:1},512)]),r("div",at,[r("button",{type:"button",class:"btn",onClick:n[0]||(n[0]=U=>_())},[b(v,{class:"btnIcon",name:"icon-park-solid:correct",style:{color:"green"},size:"20px"}),n[2]||(n[2]=j("Yes",-1))]),r("button",{type:"button",class:"btn",onClick:n[1]||(n[1]=U=>I())},[b(v,{class:"btnIcon",name:"icomoon-free:cross",style:{color:"red"},size:"20px"}),n[3]||(n[3]=j("No",-1))])])])])}}},ct=k(rt,[["__scopeId","data-v-687114f2"]]),_t={__name:"[slug]",async setup(h){let e,i;const o=S(),m=([e,i]=y(()=>E.get()),e=await e,i(),e);return L(async()=>{}),(u,c)=>{const a=ct,d=J;return C(),T(d,null,{default:z(()=>[b(a)]),_:1})}}};export{_t as default};
